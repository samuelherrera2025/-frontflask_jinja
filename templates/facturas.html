{% extends "base.html" %}
{% block contenido %}
<h1>Gestión de Facturas</h1>

<form method="post" action="{{ url_for('rutas_facturas.crear_factura') if modo == 'crear' else url_for('rutas_facturas.actualizar_factura') }}">
    <input type="hidden" name="numero" value="{{ factura.numero if factura else '' }}">
    <input type="datetime-local" name="fecha" value="{{ factura.fecha if factura else '' }}" required>
    <input type="number" step="0.01" name="total" placeholder="Total" value="{{ factura.total if factura else '' }}" required>
    <input type="number" name="fkidcliente" placeholder="ID Cliente" value="{{ factura.fkidcliente if factura else '' }}" required>
    <input type="number" name="fkidvendedor" placeholder="ID Vendedor" value="{{ factura.fkidvendedor if factura else '' }}" required>
    <button type="submit">{{ "Crear" if modo == "crear" else "Actualizar" }}</button>
</form>

<form method="post" action="{{ url_for('rutas_facturas.buscar_factura') }}">
    <input type="text" name="codigo_buscar" placeholder="Buscar por número">
    <button type="submit">Buscar</button>
</form>

{% if mensaje %}<p style="color:red;">{{ mensaje }}</p>{% endif %}

<table border="1" cellpadding="5" cellspacing="0" style="margin:20px auto;">
<thead>
<tr><th>Número</th><th>Fecha</th><th>Total</th><th>ID Cliente</th><th>ID Vendedor</th><th>Acciones</th></tr>
</thead>
<tbody>
{% for f in facturas %}
<tr>
  <td>{{ f.numero }}</td>
  <td>{{ f.fecha }}</td>
  <td>{{ f.total }}</td>
  <td>{{ f.fkidcliente }}</td>
  <td>{{ f.fkidvendedor }}</td>
  <td>
    <form method="post" action="{{ url_for('rutas_facturas.eliminar_factura', numero=f.numero) }}">
      <button type="submit">Eliminar</button>
    </form>
  </td>
</tr>
{% endfor %}
</tbody>
</table>
{% endblock %}
